/* =====================================================================
   THEME PACK — MERGED INTO styles.css
   - Default theme: fern (from your provided mock)
   - Extra themes: neon, ocean, rose, ember, mint, dawn
   - Floating Theme Switcher styles (no external files)
   ===================================================================== */

/* ---------- Theme Tokens (7 themes) ---------- */
/* Fern (your mock — default) */
:root, :root[data-theme="fern"]{
  --bg:#0C3B2E; --surface:#0F4A3B; --panel:#133F34; --card:#153F34;
  --text:#EAF4EE; --text-muted:#BFD4C7; --text-dim:#9DB8AA;
  --primary:#6D9773; --primary-600:#5B8464; --primary-700:#4A6E54;
  --accent:#FFBA00; --accent-700:#B46617;
  --error:#E05353; --success:#58C58C; --warning:#FFBA00;
  --border:rgba(255,255,255,0.12); --border-strong:rgba(255,255,255,0.22);
  --input-bg:#0F4236; --input-focus:#6D9773;
  --pill-bg:rgba(255,255,255,0.06); --pill-text:#EAF4EE;
  --shadow-1:0 6px 24px rgba(0,0,0,0.28); --shadow-2:0 10px 34px rgba(0,0,0,0.35);
  --radius-sm:8px; --radius:12px; --radius-lg:18px;
  --table-header:rgba(255,255,255,0.06); --table-row:rgba(255,255,255,0.03); --table-row-alt:rgba(255,255,255,0.05);
}

/* Neon */
:root[data-theme="neon"]{
  --bg:#0b1020; --surface:#0f162e; --panel:#111a33; --card:#111a33;
  --text:#f2f5ff; --text-muted:#a7b0cc; --text-dim:#8f9ab3;
  --primary:#7c5cff; --primary-600:#6a4bf2; --primary-700:#5b3fe0;
  --accent:#2de2e6; --accent-700:#1bbec3;
  --error:#f31260; --success:#17c964; --warning:#f5a524;
  --border:rgba(255,255,255,.18); --border-strong:rgba(255,255,255,.28);
  --input-bg:rgba(255,255,255,.06); --input-focus:#7c5cff;
  --pill-bg:rgba(255,255,255,.08); --pill-text:#f2f5ff;
  --shadow-1:0 8px 30px rgba(0,0,0,.25); --shadow-2:0 12px 40px rgba(0,0,0,.35);
  --radius-sm:8px; --radius:12px; --radius-lg:18px;
  --table-header:rgba(255,255,255,.06); --table-row:rgba(255,255,255,.03); --table-row-alt:rgba(255,255,255,.06);
}

/* Ocean */
:root[data-theme="ocean"]{
  --bg:#07121b; --surface:#0a1a28; --panel:#0c2333; --card:#0c2333;
  --text:#e9f6ff; --text-muted:#8fb0c8; --text-dim:#7aa0ba;
  --primary:#29b6f6; --primary-600:#18a3e6; --primary-700:#0f8fcf;
  --accent:#4df2c8; --accent-700:#2fdcae;
  --error:#ff5a7a; --success:#31d69b; --warning:#ffcb57;
  --border:rgba(255,255,255,.16); --border-strong:rgba(255,255,255,.26);
  --input-bg:rgba(255,255,255,.05); --input-focus:#29b6f6;
  --pill-bg:rgba(255,255,255,.07); --pill-text:#e9f6ff;
  --shadow-1:0 8px 28px rgba(0,0,0,.25); --shadow-2:0 12px 40px rgba(0,0,0,.35);
  --radius-sm:8px; --radius:12px; --radius-lg:18px;
  --table-header:rgba(255,255,255,.05); --table-row:rgba(255,255,255,.03); --table-row-alt:rgba(255,255,255,.06);
}

/* Rose */
:root[data-theme="rose"]{
  --bg:#180d16; --surface:#22121f; --panel:#2a1626; --card:#2a1626;
  --text:#fff2f6; --text-muted:#e0b9c9; --text-dim:#d49db4;
  --primary:#ff6aa2; --primary-600:#ff5796; --primary-700:#ff458a;
  --accent:#ffd36e; --accent-700:#f0b94c;
  --error:#ff4d6d; --success:#49e0a6; --warning:#ffc36b;
  --border:rgba(255,255,255,.18); --border-strong:rgba(255,255,255,.28);
  --input-bg:rgba(255,255,255,.07); --input-focus:#ff6aa2;
  --pill-bg:rgba(255,255,255,.09); --pill-text:#fff2f6;
  --shadow-1:0 8px 30px rgba(0,0,0,.28); --shadow-2:0 12px 40px rgba(0,0,0,.38);
  --radius-sm:8px; --radius:12px; --radius-lg:18px;
  --table-header:rgba(255,255,255,.07); --table-row:rgba(255,255,255,.04); --table-row-alt:rgba(255,255,255,.07);
}

/* Ember */
:root[data-theme="ember"]{
  --bg:#160d0a; --surface:#1e1310; --panel:#271813; --card:#271813;
  --text:#fff3ec; --text-muted:#e5c5b5; --text-dim:#d6ab95;
  --primary:#ff8a4c; --primary-600:#ff7a33; --primary-700:#f46a1f;
  --accent:#ffd166; --accent-700:#e7b44a;
  --error:#ff5c5c; --success:#3fd0a6; --warning:#ffcc66;
  --border:rgba(255,255,255,.16); --border-strong:rgba(255,255,255,.26);
  --input-bg:rgba(255,255,255,.06); --input-focus:#ff8a4c;
  --pill-bg:rgba(255,255,255,.08); --pill-text:#fff3ec;
  --shadow-1:0 8px 30px rgba(0,0,0,.25); --shadow-2:0 12px 40px rgba(0,0,0,.35);
  --radius-sm:8px; --radius:12px; --radius-lg:18px;
  --table-header:rgba(255,255,255,.06); --table-row:rgba(255,255,255,.03); --table-row-alt:rgba(255,255,255,.06);
}

/* Mint */
:root[data-theme="mint"]{
  --bg:#061610; --surface:#0b231a; --panel:#0f2c22; --card:#103126;
  --text:#eaf4ee; --text-muted:#bfe0d0; --text-dim:#a5cbb9;
  --primary:#33d18f; --primary-600:#2cc081; --primary-700:#25a870;
  --accent:#4ad8ff; --accent-700:#36c7ef;
  --error:#f06060; --success:#35d6a1; --warning:#ffd877;
  --border:rgba(255,255,255,.14); --border-strong:rgba(255,255,255,.24);
  --input-bg:rgba(255,255,255,.05); --input-focus:#33d18f;
  --pill-bg:rgba(255,255,255,.07); --pill-text:#eaf4ee;
  --shadow-1:0 8px 30px rgba(0,0,0,.25); --shadow-2:0 12px 40px rgba(0,0,0,.35);
  --radius-sm:8px; --radius:12px; --radius-lg:18px;
  --table-header:rgba(255,255,255,.05); --table-row:rgba(255,255,255,.03); --table-row-alt:rgba(255,255,255,.06);
}

/* Dawn (light) */
:root[data-theme="dawn"]{
  --bg:#f7f7fb; --surface:#ffffff; --panel:#ffffff; --card:#ffffff;
  --text:#0e102a; --text-muted:#58607a; --text-dim:#7b839d;
  --primary:#5b6cff; --primary-600:#4a5cf0; --primary-700:#3f4fdd;
  --accent:#16b2c9; --accent-700:#1297ab;
  --error:#c62828; --success:#2e7d32; --warning:#b26a00;
  --border:rgba(10,10,30,.10); --border-strong:rgba(10,10,30,.18);
  --input-bg:rgba(10,10,20,.04); --input-focus:#5b6cff;
  --pill-bg:rgba(10,10,20,.06); --pill-text:#0e102a;
  --shadow-1:0 6px 18px rgba(0,0,0,.06); --shadow-2:0 10px 28px rgba(0,0,0,.08);
  --radius-sm:8px; --radius:12px; --radius-lg:18px;
  --table-header:rgba(10,10,30,.06); --table-row:rgba(10,10,30,.03); --table-row-alt:rgba(10,10,30,.06);
}

/* ---------- Base + nice transitions ---------- */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; color:var(--text);
  font:14px/1.5 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
  /* مهم: خلفية تعتمد على متغيرات الثيم، لا ألوان ثابتة */
  background: linear-gradient(180deg, var(--bg) 0%, color-mix(in oklab, var(--surface) 85%, var(--bg)) 100%);
}
*, *::before, *::after{
  transition:
    background-color .2s ease, border-color .2s ease, color .2s ease,
    box-shadow .2s ease, transform .08s ease;
}

/* ---------- Floating Theme Switcher (no external files) ---------- */
#theme-switcher{
  position: fixed; inset: auto 16px 16px auto; z-index: 3000;
  display: grid; gap: 8px; align-items: end; justify-items: end;
  font-family: inherit;
}
#theme-switcher .toggle{
  background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
  color: #0F2A21; border: none; padding: 10px 12px; border-radius: 12px;
  cursor: pointer; box-shadow: var(--shadow-1); font-weight: 800;
}
#theme-panel{
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 14px; box-shadow: var(--shadow-2);
  padding: 10px; display: none; min-width: 220px; backdrop-filter: blur(8px) saturate(120%);
}
#theme-switcher.open #theme-panel{ display: block; }
#theme-panel .row{ display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
.theme-chip{
  display: inline-flex; align-items: center; justify-content: center;
  padding: 8px 10px; border-radius: 12px; border: 1px solid var(--border);
  background: var(--panel); color: var(--text); cursor: pointer; font-weight: 700;
}
.theme-chip:hover{ transform: translateY(-1px); border-color: var(--primary); }
.theme-chip.active{ box-shadow: 0 8px 28px color-mix(in oklab, var(--primary) 35%, transparent);
  background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%); color:#fff; border-color: transparent;
}
@media print{ #theme-switcher{ display:none !important; } }

/* =====================================================================
   YOUR ORIGINAL STYLES (kept as-is, now powered by the tokens above)
   ===================================================================== */

/* Layout */
.container{ max-width:1100px; margin:0 auto; padding:24px; }
.section-title{ display:flex; align-items:center; justify-content:space-between; margin:12px 0 8px; }
.section-title h3{ margin:0; font-size:18px; font-weight:600; color:var(--text); } /* تكبير العناوين */
.muted{ color:var(--text-muted); }
.text-lg{ font-size:20px; }
.font-semibold{ font-weight:600; }
.flex{ display:flex; }
.grid{ display:grid; }
.gap-1{ gap:8px; }
.gap-2{ gap:12px; }
.items-center{ align-items:center; }
.justify-between{ justify-content:space-between; }
.mb-1{ margin-bottom:8px; }
.mt-1{ margin-top:8px; }
.mt-2{ margin-top:16px; }

/* Cards */
.card{
  background: var(--card); border: 1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow-1); padding: 12px;
}
.card.soft{ background: rgba(255,255,255,0.04); border-color: var(--border); }

/* Inputs */
input[type="text"], input[type="number"], input[type="date"], select, textarea{
  width:100%; padding:10px 12px; color: var(--text); background: var(--input-bg);
  border:1px solid var(--border); border-radius: var(--radius-sm); outline: none; transition: border-color .15s ease, box-shadow .15s ease, background .15s;
}
textarea{ min-height: 90px; resize: vertical; }
input::placeholder, textarea::placeholder{ color: var(--text-dim); }
input:focus, select:focus, textarea:focus{ border-color: var(--input-focus); box-shadow: 0 0 0 2px color-mix(in oklab, var(--primary) 35%, transparent); }
.form-group label{ display:block; margin-bottom:6px; color:var(--text-muted); font-size:12px; letter-spacing:.2px; }

/* Buttons */
.btn{
  --btn-bg: var(--pill-bg); --btn-text: var(--text);
  display:inline-flex; align-items:center; justify-content:center; gap:8px;
  padding:10px 14px; border-radius: 999px; background: var(--btn-bg); color: var(--btn-text);
  border:1px solid var(--border); cursor:pointer; transition: transform .05s ease, background .2s ease, border-color .2s;
}
.btn:hover{ transform: translateY(-1px); border-color: var(--border-strong); }
.btn:active{ transform: translateY(0); }
.btn-primary{ --btn-bg: var(--primary); --btn-text: #0F2A21; border-color: transparent; font-weight:600; }
.btn-primary:hover{ background: var(--primary-600); }
.btn-primary:active{ background: var(--primary-700); }
.btn-danger{ --btn-bg: #B33A3A; --btn-text: #fff; border-color: rgba(0,0,0,0.1); }
.btn-icon{ width:36px; height:36px; padding:0; border-radius:999px; font-size:18px; }

/* Pills / badges */
.pill{ display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:999px; background: var(--pill-bg); color: var(--pill-text); border:1px solid var(--border); font-size:12px; }
.badge{ display:inline-flex; align-items:center; gap:6px; padding:4px 8px; border-radius:999px; background:rgba(255,186,0,0.15); color:#FFD977; font-weight:600; font-size:11px; }

/* Table */
.table{ width:100%; border-collapse: separate; border-spacing:0; overflow:hidden; border-radius: var(--radius); border:1px solid var(--border); }
.table thead th{ background: var(--table-header); color: var(--text-muted); font-weight:600; text-align:left; font-size:12px; padding:10px 12px; border-bottom:1px solid var(--border); }
.table tbody td{ padding:10px 12px; border-bottom:1px solid var(--border); background: var(--table-row); }
.table tbody tr:nth-child(even) td{ background: var(--table-row-alt); }
.table tbody tr{ cursor: pointer; }

/* Header bar (filters) — sticky فوق الجدول */
.header-bar{
  position: sticky; top: 0; z-index: 50;
  background: linear-gradient(90deg, color-mix(in oklab, var(--primary) 20%, transparent), color-mix(in oklab, var(--accent) 16%, transparent));
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  padding: 12px; margin-top: 8px; margin-bottom: 10px;
}

/* Filter chip */
.filter-chip{
  display:inline-flex; align-items:center; gap:8px;
  background: color-mix(in oklab, var(--accent) 18%, transparent); color: #FFD877;
  border:1px solid color-mix(in oklab, var(--accent) 45%, var(--border) 55%);
  padding: 8px 12px; border-radius: 999px; cursor: pointer; user-select:none;
}
.filter-chip input{ accent-color: var(--accent); }

/* Modal (عام) */
.modal-wrap{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:999; }
.modal-overlay{ position:absolute; inset:0; background: rgba(0,0,0,0.45); }
.modal{
  position:relative; z-index:1;
  width:min(780px, calc(100vw - 28px));
  max-height: calc(100vh - 28px);
  overflow:auto; background: var(--surface);
  border:1px solid var(--border-strong); border-radius: 22px; box-shadow: var(--shadow-2);
}
.modal-header{ position:sticky; top:0; padding:14px 16px; background: linear-gradient(180deg, var(--surface) 0%, color-mix(in oklab, var(--surface) 75%, var(--panel)) 100%); border-bottom:1px solid var(--border); border-top-left-radius: 22px; border-top-right-radius: 22px; }
.modal-body{ padding:16px; }
.modal-footer{ position:sticky; bottom:0; display:flex; gap:10px; justify-content:flex-end; padding:12px 16px; background: linear-gradient(0deg, var(--surface) 0%, color-mix(in oklab, var(--surface) 75%, var(--panel)) 100%); border-top:1px solid var(--border); border-bottom-left-radius: 22px; border-bottom-right-radius: 22px; }

/* Links */
a{ color: var(--accent); text-decoration: none; }
a:hover{ text-decoration: underline; }

/* Scrollbars */
*::-webkit-scrollbar{ width:12px; height:12px; }
*::-webkit-scrollbar-thumb{ background: rgba(255,255,255,0.14); border-radius: 999px; border:3px solid transparent; background-clip: padding-box; }
*::-webkit-scrollbar-track{ background: transparent; }

/* أزرار الإجراءات المصغّرة داخل الجدول */
.table .btn{ min-width: 36px; padding:6px 8px; }

/* ==== إضافات لتثبيت عمود Name وتفعيل Scroll داخل الكارد ==== */

/* حاوية جدول عامة داخل الكارد (أفقي + عمودي) */
.table-host{
  overflow: auto;               /* أفقي + عمودي */
  max-height: 420px;            /* يمنع خروج الجدول من الكارد */
  border-radius: var(--radius);
}

/* دعم تعطيل grade bar عند قفل G0 */
.grade-bar.disabled{
  opacity: .55;
  pointer-events: none;
}

/* شريط إجراءات ثابت أسفل كارد الفورم */
.form-sticky-actions{
  position: sticky;
  bottom: -1px;
  display: flex;
  gap: 10px;
  justify-content: flex-end;
  padding-top: 8px;
  margin-top: 8px;
  background: linear-gradient(180deg, transparent, rgba(0,0,0,0.12));
  border-top: 1px solid var(--border);
}

/* بادج حانب زر حفظ المودال */
#ph_due_badge.hidden{ display:none; }

/* ======= Saved area layout & zoom controls (for Saved assessments) ======= */
:root{ --saved-toolbar-w: 92px; }

.saved-layout{
  display:grid;
  grid-template-columns: var(--saved-toolbar-w) 1fr;
  gap:12px;
  align-items:start;
}

.saved-toolbar{
  position:sticky;
  top:8px;
  width:var(--saved-toolbar-w);
  min-height:92px; /* مربع صغير */
  border:1px solid var(--border);
  border-radius:12px;
  background:var(--surface-2, rgba(255,255,255,0.04));
  display:grid;
  place-items:center;
  z-index:0; /* لا يطفو فوق الجداول */
}
.saved-toolbar .hint{
  font-size:11px; text-align:center; opacity:.75; padding:6px;
}

.saved-stage-wrap{
  position:relative;
  display:grid;
  place-items:start center; /* يبقي المحتوى بوسط المحور الأفقي */
  overflow:visible;
  min-height:120px;
}
.saved-stage{
  transform-origin: top center;
  will-change: transform;
}

.resizer{
  position:absolute; top:0; bottom:0; width:14px;
  cursor:ew-resize; z-index:5;
}
.resizer-left{ left:-6px; }
.resizer-right{ right:-6px; }
.resizer::after{
  content:"";
  position:absolute; top:12px; bottom:12px; left:3px; right:3px;
  border:1px dashed var(--border);
  border-radius:999px;
  opacity:.35;
  transition:opacity .2s ease;
  pointer-events:none;
}
.resizer:hover::after{ opacity:.7; }

/* Table card minor tweak */
.table-card .card-title{ display:flex; align-items:center; justify-content:space-between; margin-bottom:12px; }
